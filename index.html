<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="user-scalable=no">
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<title>WebSocket - Simple Example</title>
  <style>
		html, body {
			margin: 0;
			padding: 0;
			color: #444;
			font-family: arial;
		}
    #header {
      text-align: center;
      width: 600px;
      font-size: 13px;
      margin: 20px auto;
    }
		#message {
      font-size: 12px;
      padding: 10px;
      border: 1px #f0f0f0 solid;
      width: 100px;
      margin: 20px auto;
      text-align: center;
      border-radius: 4px;
    }
    </style>
  </head>
  <body>
    <div id="header"><p>Move your mouse to send its coordinates to WebSocket Server and back to the browser</p></div>
    <div id="message"></div>
  </body>

  <script type="text/javascript">
    let HOST = location.origin.replace(/^http/, 'ws')
    let ws = new WebSocket(HOST);
    ws.binaryType = 'arraybuffer';
    let message = document.getElementById('message');

    window.addEventListener('click', function(event) {
      ws.send('Click!');
    });
    window.addEventListener('mousemove', function(event){
      let buffer = new ArrayBuffer(4);
      let coords = new Uint16Array(buffer);
      coords[0] = event.clientX;
      coords[1] = event.clientY;
      ws.send(coords);
    });

    ws.onopen = (event) => {
      console.log('Connected to Server');

      ws.onmessage = (event) => {
        if(event.data instanceof ArrayBuffer) {
          let arr = new Uint16Array(event.data);
          message.innerHTML = `x: ${arr[0]}, y: ${arr[1]}`;
        }
      }

    }
  </script>

</html>
